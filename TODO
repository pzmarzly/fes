- server_side_upgrade_pred(..., accept_only: fn(SigningPubKey) -> bool)
- actual encryption

different ideas:
    - merge with `movie` and have code like:
        fn main() { register_handler!(InitTransaction, transaction); ... }
        fn transaction(init: InitTransaction) {
            ...
            send!(InitOk);
            // Option 1. While `transaction()` is waiting, other functions can operate, using different message types.
            // Option 2. Proper channel multiplexing. Is it needed?
            expect!(NormalTransaction, UncommonTransaction, CancelTransaction) {
                NormalTransaction => ...
                UncommonTransaction => ...
                CancelTransaction => ...
            }
            send!(TransactionOk);
        }
